---
title: "后端框架测试文档"
date: 2018-06-21T14:10:38+08:00
draft: false
---

- [ 测试内容](#test-content)
    - [ 服务部署 （可选）](#deployment)
    - [ 使用提供的测试工具进行测试](#test-by-utils)
        - [测试程序参数说明](#test-params)
        - [ 登录测试](#login-test)
        - [ 游戏测试](#start-game)




# <!--test-content--> 测试内容 


## <!--deployment--> 服务部署 （可选）

### <!-- omit in toc --> 测试方法

* 参考 [部署文档](/部署文档/部署指南/) 进行服务部署

### <!-- omit in toc --> 测试要点

* 所有服务能够正常启动


## <!--test-by-utils--> 使用提供的测试工具进行测试

### <!--test-params-->测试程序参数说明

* login_server_addr 登录服监听地址，默认值为 127.0.0.1:36201
* peipai_url 配牌 url， 默认值为  http://127.0.0.1:36102
* client_version 客户端版本号， 默认值为 1.0
* dbpath 存储测试账号分配数据。如果环境变量设置了 GOPATH ,默认值为 $GOPATH。否则默认值为当前目录

### <!-- login-test --> 登录测试


####  <!-- omit in toc --> 测试方法

* 使用提供的 login.test 二进制文件测试
    ```
    ./login.test -login_server_addr 127.0.0.1:36201 -peipai_url http://127.0.0.1:36102 -dbpath ./
    ```

####  <!-- omit in toc --> 测试要点

* 登录测试程序执行流程：
    - 测试程序会分配账号 ID， 向登录服发起认证请求
    - 登录服认证通过后，获取 1 个网关服的地址，并且回复客户端
    - 测试程序收到登录服认证响应后，向对应的网关服发起认证请求
    - 网关服认证通过后，响应请求
* 在测试过程中，可以尝试关闭登录服、网关服，检测测试结果
* 测试程序最后一行输出为 PASS 时代表上述流程执行通过

### <!-- start-game --> 游戏测试

#### <!-- omit in toc --> 测试方法

* 使用提供的 startgame.test 进行测试
    ```
    ./startgame.test -login_server_addr 127.0.0.1:36201 -peipai_url http://127.0.0.1:36102 -dbpath ./
    ```

#### <!-- omit in toc --> 测试要点

* 开始游戏测试程序执行流程：
    - 登录 4 个玩家， 并且向服务器发起匹配请求。
    - 匹配服会处理匹配请求，当有 4 个玩家进行匹配时， 会通知 room 服创建房间
    - room 服创建房间后，会通知客户端创建房间成功和开始游戏
    - 测试程序会校验是否正确收到服务器的消息
* 在测试过程中，可以尝试关闭匹配服、登录服、网关服、room 服来检测测试结果
* 测试程序最后一行输出为 PASS 时代表上述流程执行通过

